# GitHub Actions Runner Token Refresh - Cron Job Configuration
#
# This file shows example cron job configurations for automatic token refresh.
# Choose one of the examples below based on your needs.
#
# Installation:
#   1. Edit the paths and organization name below
#   2. Copy the desired cron line to your crontab:
#      crontab -e
#   3. Or copy this file to /etc/cron.d/github-runner-token-refresh

# ============================================================================
# OPTION 1: Run every 30 minutes (recommended for production)
# ============================================================================
# This checks token expiration every 30 minutes and refreshes if needed.
# Tokens expire after 1 hour, so checking every 30 minutes provides safety margin.

# */30 * * * * runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh --org your-org >> /var/log/github-runner-token-refresh.log 2>&1

# ============================================================================
# OPTION 2: Run every 15 minutes (more frequent checks)
# ============================================================================
# More frequent checks for critical environments.

# */15 * * * * runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh --org your-org >> /var/log/github-runner-token-refresh.log 2>&1

# ============================================================================
# OPTION 3: Run every hour at :50 minutes (conservative)
# ============================================================================
# Checks once per hour, 10 minutes before typical token expiration.
# Less system load but smaller safety margin.

# 50 * * * * runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh --org your-org >> /var/log/github-runner-token-refresh.log 2>&1

# ============================================================================
# OPTION 4: Multiple organizations
# ============================================================================
# If you manage runners for multiple organizations.

# */30 * * * * runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh --org org1 --runner-dir /home/runner/actions-runner-org1 >> /var/log/github-runner-token-refresh-org1.log 2>&1
# */30 * * * * runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh --org org2 --runner-dir /home/runner/actions-runner-org2 >> /var/log/github-runner-token-refresh-org2.log 2>&1

# ============================================================================
# OPTION 5: With environment variables
# ============================================================================
# Load configuration from environment file.

# SHELL=/bin/bash
# RUNNER_ORG=your-org
# RUNNER_DIR=/home/runner/actions-runner
# REFRESH_THRESHOLD=300
# */30 * * * * runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh >> /var/log/github-runner-token-refresh.log 2>&1

# ============================================================================
# RECOMMENDED: Example for /etc/cron.d/ (run as root to install)
# ============================================================================
# This format is suitable for /etc/cron.d/ files.
# Copy this file to /etc/cron.d/github-runner-token-refresh

# SHELL=/bin/bash
# PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
# MAILTO=admin@example.com

# Check and refresh token every 30 minutes
# 0,30 * * * * runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh --org your-org-name >> /var/log/github-runner-token-refresh.log 2>&1

# ============================================================================
# NOTES:
# ============================================================================
# - Ensure the runner user has permissions to write to log files
# - Create log directory if needed: mkdir -p /var/log && touch /var/log/github-runner-token-refresh.log
# - Set proper permissions: chown runner:runner /var/log/github-runner-token-refresh.log
# - GitHub CLI (gh) must be installed and authenticated for the runner user
# - Test the script manually before adding to cron:
#     sudo -u runner /home/runner/scripts/runner-token-refresh.sh --check-and-refresh --org your-org --dry-run
# - Monitor logs regularly: tail -f /var/log/github-runner-token-refresh.log
