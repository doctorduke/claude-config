# CI Failure Analysis and Fix Prompt
Analyze and fix the CI failure in the {PROJECT_NAME} monorepo.

## CI Failure Context
- **Job Name**: {CI_JOB_NAME}
- **Workflow**: {WORKFLOW_NAME}
- **Branch**: {BRANCH_NAME}
- **Commit**: {COMMIT_SHA}
- **Trigger**: {TRIGGER_EVENT}

## Error Details
```
{ERROR_OUTPUT}
```

## Failed Command
```bash
{FAILED_COMMAND}
```

## Analysis Requirements
1. **Root Cause**: Identify the underlying issue
2. **Scope**: Determine affected packages/platforms
3. **Dependencies**: Check for dependency conflicts
4. **Environment**: Consider CI environment differences
5. **Regression**: Identify if this worked previously

## Common CI Issues to Check
- Node version compatibility (requires >= 23.11.0)
- pnpm workspace resolution failures
- Turborepo cache invalidation needed
- Missing environment variables
- Type errors from shared packages
- Build order dependencies in turbo.json
- Platform-specific build issues
- Test timeout or flakiness

## Fix Strategy
1. **Immediate Fix**: Minimal change to unblock CI
2. **Proper Solution**: Long-term fix if different
3. **Prevention**: How to prevent recurrence
4. **Testing**: Verification steps

## Output Format
### Diagnosis
- **Issue Type**: [build/test/lint/type/dependency]
- **Root Cause**: Clear explanation
- **Affected Packages**: List of @umemee/* packages

### Solution
```diff
# Show the exact changes needed
```

### Verification
```bash
# Commands to verify the fix locally
```

### Prevention
- Configuration changes needed
- Additional CI checks to add
- Documentation updates required
---
name: code-fix
description: Analyzes CI failures and provides targeted fixes for monorepo build issues
usage: GitHub Actions on CI failure, local debugging of build errors
variables:
  - name: PROJECT_NAME
    description: Name of the project
    default: umemee-v0
  - name: CI_JOB_NAME
    description: Name of the failed CI job
    required: true
  - name: WORKFLOW_NAME
    description: GitHub Actions workflow name
    required: true
  - name: BRANCH_NAME
    description: Branch where failure occurred
    required: true
  - name: COMMIT_SHA
    description: Commit SHA that failed
    required: true
  - name: TRIGGER_EVENT
    description: What triggered the CI run (push/pull_request/workflow_dispatch)
    default: push
  - name: ERROR_OUTPUT
    description: The error output from the CI logs
    required: true
  - name: FAILED_COMMAND
    description: The specific command that failed
    required: true